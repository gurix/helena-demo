.row
  .col-xs-12.col-md-2
    = image_tag 'logo.png', alt: 'Helena Demo', class: 'logo'
  .col-xs-12.col-md-9
    %h1 Helena Demo App
    %p Helena is an online survey/test framework designed for agile survey/test development, longitudinal studies and instant feedback.

    - if user_signed_in?
      %p== Below you see an overview of all published surveys. In this demo you can manage them in the #{link_to 'admin section', helena.admin_surveys_path}.

      %p== You are logged in as #{current_user.name}. #{link_to 'Sign out here', main_app.destroy_user_session_path, method: :delete} if you need to change the account.
    - else
      %p
        Below you see an overview of all published surveys. You can
        = link_to 'log in', main_app.user_session_path
        to take part. Once you logged in, you can also setup your own surveys and play around.

- @surveys.each do |survey|
  - if survey.newest_version.version > 0
    .panel.panel-default.survey
      .panel-heading= survey.newest_version.survey_detail.title
      .panel-body
        %p= survey.newest_version.survey_detail.description
        - if user_signed_in?
          = link_to t('.new_session'), main_app.new_survey_questionary_session_path(survey), class: 'btn btn-success pull-right'
        - else
          = link_to t('.sign_in'), main_app.user_session_path, class: 'btn btn-primary  pull-right'

      - if user_signed_in?
        - if current_user.questionary_sessions.where(survey: survey).any?
          %table.table
            %tbody
              - current_user.questionary_sessions.where(survey: survey).asc(:created_at).each do |session|
                %tr
                  %td.icon{class: "#{ session.completed? ? 'text-success' : 'text-danger'}"}
                    - if session.completed?
                      %span.glyphicon.glyphicon-ok-circle{ title: t('.session_completed') }
                    - else
                      %span.glyphicon.glyphicon-warning-sign{ title: t('.session_not_completed') }
                  %td.created_at
                    = time_ago_in_words(session.created_at)
                  %td.version
                    = Helena::Version.model_name.human
                    = survey.versions.find(session.version_id).version
                  %td
                    - if session.completed?

                    - else
                      = link_to t('.proceed'), helena.edit_survey_session_path(survey, session)

#languages
  = link_to main_app.root_path(locale: :de) do
    View this site also in German
    %img{ src: image_path('icon_de.png'), alt: 'German' }
